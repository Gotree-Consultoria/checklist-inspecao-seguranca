<div class="agenda-root">
  <div class="agenda-header">
    <h2>Agenda</h2>
    <div class="header-actions">
      <div class="view-tabs">
        <button 
          type="button" 
          class="tab-btn" 
          [class.active]="viewMode === 'calendar'"
          (click)="switchView('calendar')">
          ğŸ“… CalendÃ¡rio
        </button>
        <button 
          type="button" 
          class="tab-btn" 
          [class.active]="viewMode === 'list'"
          (click)="switchView('list')">
          ğŸ“‹ Listagem
        </button>
      </div>
      <button type="button" class="btn-primary" (click)="createNew()">+ Novo Evento</button>
      <button type="button" class="btn-secondary" (click)="loadEventos()">ğŸ”„ Atualizar</button>
    </div>
  </div>

  <div *ngIf="loading" class="loading-state">Carregando...</div>

  <!-- Vista: CalendÃ¡rio -->
  <div *ngIf="viewMode === 'calendar'" class="calendar-container">
    <full-calendar [options]="calendarOptions"></full-calendar>
  </div>

  <!-- Vista: Listagem -->
  <div *ngIf="viewMode === 'list'" class="list-container">
    <div *ngIf="eventos.length === 0" class="empty-state">
      <p>Nenhum evento encontrado. <button type="button" (click)="createNew()" class="btn-link">Criar novo</button></p>
    </div>
    <ul class="agenda-list" *ngIf="eventos.length > 0">
      <li *ngFor="let it of eventos; trackBy: trackByEventoId" class="agenda-item" [class]="'type-' + it.type.toLowerCase()">
        <div class="left">
          <div class="title">{{ it.title }}</div>
          <div class="meta">{{ it.date }} â€¢ <span class="type" [class]="'badge-' + it.type.toLowerCase()">{{ it.type }}</span></div>
          <div class="desc" *ngIf="it.description">{{ it.description }}</div>
          <div class="log" *ngIf="it.type === 'VISITA_REAGENDADA'">
            <small>Original: {{ it.originalVisitDate }} â€¢ Fonte: {{ it.sourceVisitId }}</small>
          </div>
        </div>
        <div class="actions">
          <button type="button" class="btn-edit" (click)="editEvent(it)">
            {{ it.type === 'VISITA' ? 'ğŸ“† Reagendar' : (it.type === 'VISITA_REAGENDADA' ? 'ğŸ”„ Re-reagendar' : 'âœï¸ Editar') }}
          </button>
          <button *ngIf="it.type === 'EVENTO' || it.type === 'VISITA_REAGENDADA'" type="button" class="btn-delete" (click)="deleteEvent(it)">ğŸ—‘ï¸ Deletar</button>
        </div>
      </li>
    </ul>
  </div>

  <app-agenda-modal
    #agendaModal
    (confirmAction)="onModalConfirm($event)"
  ></app-agenda-modal>
</div>
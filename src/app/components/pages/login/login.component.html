<div class="page login-page">
  <div class="login-fixed-wrapper">
    <div class="login-hero">
      <img src="/assets/GO-TREE - Versao principal - 01.png" alt="Go-Tree Checklist" class="login-hero__img" />
    </div>
    <div class="login-box">
        <form (submit)="onSubmit($event)" class="login-form" novalidate>
          <div class="login-fields">
            <div>
              <label for="loginEmail">E-mail</label>
              <input type="email" id="loginEmail" name="username" autocomplete="username" required [(ngModel)]="email" />
            </div>
            <div>
              <label for="loginPassword">Senha</label>
              <input type="password" id="loginPassword" name="current-password" autocomplete="current-password" required [(ngModel)]="password" />
            </div>
          </div>
          <div class="remember-and-password">
            <div class="remember-me-container">
              <input type="checkbox" id="rememberMe" />
              <label for="rememberMe">Lembrar-me</label>
            </div>
            <div class="forgot-password">
              <a href="#" (click)="$event.preventDefault()">Esqueci minha senha</a>
            </div>
          </div>
          <div *ngIf="errorMessage" class="login-error" role="alert">
            {{ errorMessage }}
          </div>
          <div class="login-buttons">
            <button type="submit" class="btn btn-primary" [disabled]="loading">Entrar</button>
          </div>
        </form>
    </div>
  </div>

  <!-- Password Reset Required Modal -->
  <div *ngIf="showResetPasswordModal" class="modal-overlay">
    <div class="modal-content" (click)="$event.stopPropagation()">
      <div class="modal-header">
        <h2>Alterar Senha Obrigatoriamente</h2>
        <p class="modal-subtitle">Sua senha expirou. Por favor, escolha uma nova senha para continuar.</p>
      </div>

      <form (submit)="submitResetPassword()" class="reset-password-form" novalidate>
        <div class="form-group">
          <label for="newPassword">Nova Senha</label>
          <input 
            type="password" 
            id="newPassword" 
            class="form-control"
            [(ngModel)]="resetPasswordForm.newPassword"
            name="newPassword"
            placeholder="Mínimo 8 caracteres"
            required
            [disabled]="resetPasswordLoading"
            autocomplete="new-password"
          />
        </div>

        <div class="form-group">
          <label for="confirmPassword">Confirmar Senha</label>
          <input 
            type="password" 
            id="confirmPassword" 
            class="form-control"
            [(ngModel)]="resetPasswordForm.confirmPassword"
            name="confirmPassword"
            placeholder="Repita a nova senha"
            required
            [disabled]="resetPasswordLoading"
            autocomplete="new-password"
          />
        </div>

        <div *ngIf="resetPasswordError" class="error-message" role="alert">
          {{ resetPasswordError }}
        </div>

        <div class="form-actions">
          <button 
            type="submit" 
            class="btn btn-primary"
            [disabled]="resetPasswordLoading"
          >
            {{ resetPasswordLoading ? 'Alterando...' : 'Alterar Senha' }}
          </button>
        </div>
      </form>
      
      <p class="modal-info">Este é um passo obrigatório de segurança. Você não conseguirá sair sem alterar sua senha.</p>
    </div>
  </div>
</div>

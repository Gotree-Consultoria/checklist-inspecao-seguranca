<section class="client-form-page page">
	<div class="container">
		<h1 class="page-title">{{ pageTitle }}</h1>

		<div class="form-container">
			<form [formGroup]="form" (ngSubmit)="onSubmit()" class="client-form">
				<!-- Campo: Nome -->
				<div class="form-group">
					<label for="name" class="form-label">Nome do Cliente *</label>
					<input 
						type="text" 
						id="name" 
						class="form-input" 
						formControlName="name"
						[disabled]="isSaving"
						placeholder="Ex: Cliente ABC Ltda">
					<div class="error-message" *ngIf="form.get('name')?.invalid && form.get('name')?.touched">
						<span *ngIf="form.get('name')?.errors?.['required']">Nome é obrigatório</span>
						<span *ngIf="form.get('name')?.errors?.['minlength']">Nome deve ter pelo menos 3 caracteres</span>
					</div>
				</div>

				<!-- Campo: E-mail -->
				<div class="form-group">
					<label for="email" class="form-label">E-mail do Cliente *</label>
					<input 
						type="email" 
						id="email" 
						class="form-input" 
						formControlName="email"
						[disabled]="isSaving"
						placeholder="cliente@email.com">
					<div class="error-message" *ngIf="form.get('email')?.invalid && form.get('email')?.touched">
						<span *ngIf="form.get('email')?.errors?.['required']">E-mail é obrigatório</span>
						<span *ngIf="form.get('email')?.errors?.['email']">E-mail inválido</span>
					</div>
				</div>

				<!-- Campo: Seleção de Empresas -->
				<div class="form-group">
					<label class="form-label">Empresas Vinculadas *</label>
					
					<div class="companies-summary" *ngIf="selectedCompanyIds.size > 0">
						<strong>Selecionadas ({{ selectedCompanyIds.size }}):</strong> {{ getSelectedCompanyNames() }}
					</div>
					<div class="companies-summary empty" *ngIf="selectedCompanyIds.size === 0">
						Nenhuma empresa selecionada
					</div>

					<div class="companies-list" [class.loading]="isLoading">
						<div *ngIf="isLoading" class="spinner">Carregando empresas...</div>
						
						<div *ngFor="let company of companies" class="company-item">
							<label class="checkbox-label">
								<input 
									type="checkbox" 
									class="checkbox-input"
									[checked]="isCompanySelected(company.id)"
									(change)="toggleCompanySelection(company.id, $event)"
									[disabled]="isSaving">
								<span class="checkbox-text">{{ company.name }}</span>
								<span class="checkbox-cnpj">(CNPJ: {{ company.cnpj || 'N/A' }})</span>
							</label>
						</div>

						<div *ngIf="companies.length === 0 && !isLoading" class="empty-message">
							Nenhuma empresa disponível
						</div>
					</div>
				</div>

				<!-- Botões de Ação -->
				<div class="form-actions">
					<button 
						type="button" 
						class="btn btn-secondary"
						(click)="onCancel()"
						[disabled]="isSaving">
						Cancelar
					</button>
					<button 
						type="submit" 
						class="btn btn-primary"
						[disabled]="form.invalid || isSaving || isLoading">
						{{ isSaving ? 'Salvando...' : (clientId ? 'Atualizar' : 'Criar') }}
					</button>
				</div>
			</form>
		</div>
	</div>
</section>

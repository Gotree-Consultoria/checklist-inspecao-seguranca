<section class="client-list-page page">
	<div class="container">
		<div class="page-header">
			<h1 class="page-title">Gestão de Clientes</h1>
			<button class="btn btn-primary" (click)="newClient()" [disabled]="isLoading">
				+ Novo Cliente
			</button>
		</div>

		<div class="clients-table-container">
			<div *ngIf="isLoading" class="loading-overlay">
				<div class="spinner">Carregando clientes...</div>
			</div>

			<table *ngIf="!isLoading && clients.length > 0">
				<thead>
					<tr>
						<th>Nome</th>
						<th>E-mail</th>
						<th>Empresas Vinculadas</th>
						<th class="actions-header">Ações</th>
					</tr>
				</thead>
				<tbody>
					<tr *ngFor="let client of clients; let i = index" [attr.data-index]="i">
						<td data-label="Nome">{{ client.name }}</td>
						<td data-label="E-mail">{{ client.email }}</td>
						<td data-label="Empresas">{{ getCompanyNames(client) }}</td>
						<td class="actions-cell" data-label="Ações">
							<button 
								class="icon-btn" 
								(click)="editClient(client)" 
								title="Editar"
								[disabled]="isLoading">
								<!-- Edit icon -->
								<svg class="icon-svg" width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
									<path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7" stroke="#374151" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/>
									<path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z" stroke="#374151" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/>
								</svg>
							</button>
							<button 
								class="icon-btn delete" 
								(click)="deleteClient(client)" 
								title="Excluir"
								[disabled]="isLoading">
								<!-- Delete icon -->
								<svg class="icon-svg" width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
									<path d="M19 6l-1 14a2 2 0 0 1-2 2H8a2 2 0 0 1-2-2L5 6M10 11v6M14 11v6M3 6h18M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2" stroke="#dc2626" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/>
								</svg>
							</button>
						</td>
					</tr>
				</tbody>
			</table>

			<div *ngIf="!isLoading && clients.length === 0" class="empty-state">
				<p>Nenhum cliente cadastrado</p>
				<button class="btn btn-primary" (click)="newClient()">Criar Primeiro Cliente</button>
			</div>
		</div>

		<!-- Pagination -->
		<div *ngIf="!isLoading && totalPages > 1" class="pagination-section">
			<div class="pagination-info">
				Página {{ currentPage + 1 }} de {{ totalPages }} | Total: {{ totalElements }} cliente(s)
			</div>

			<div class="pagination-controls">
				<div class="page-size-selector">
					<label for="page-size">Itens por página:</label>
					<select id="page-size" (change)="changeItemsPerPage($any($event.target).value)" [value]="itemsPerPage">
						<option value="5">5</option>
						<option value="10">10</option>
						<option value="20">20</option>
						<option value="50">50</option>
					</select>
				</div>

				<div class="page-navigation">
					<button 
						class="btn-pagination" 
						[disabled]="currentPage === 0"
						(click)="goToPreviousPage()">
						← Anterior
					</button>

					<div class="page-numbers">
						<button 
							*ngFor="let page of pageNumbers"
							class="btn-page"
							[class.active]="page === currentPage"
							(click)="goToPage(page)">
							{{ page + 1 }}
						</button>
					</div>

					<button 
						class="btn-pagination"
						[disabled]="currentPage === totalPages - 1"
						(click)="goToNextPage()">
						Próxima →
					</button>
				</div>
			</div>
		</div>
	</div>
</section>
